// ==UserScript==
// @name         Rename attacks (update 03.09)
// @version      1.3
// @description  Easy naming attacks (compatible with "Types villages (village)" and "Types villages (report)"
// @author       Foxtal
// @match        *://*.plemiona.pl/game.php?village=*&screen=overview_villages*subtype=attacks*
// @match        *://*.plemiona.pl/game.php?village=*&screen=overview_villages*mode=incomings*subtype=attacks&group=*&page=*&subtype=attacks*
// @match        *://*.plemiona.pl/game.php?t=*&village=*&screen=overview_villages*mode=incomings*subtype=attacks
// @match        *://*.plemiona.pl/game.php?t=*&village=*&screen=overview_villages*mode=incomings*subtype=attacks&group=*&page=*&subtype=attacks*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=plemiona.pl
// ==/UserScript==

//////////////////////////////////////////
/// ["OFF", ""] ,
    ["PADŁO", "493|474 532|546 499|457 "] ,
    ["OFF", "493|474 532|546 499|457 "] ,
    ["DEF", "493|474 532|546 499|457 532|547 501|456 554|518 496|462 556|523 556|545 563|546 562|547 393|525 397|542 395|548 394|548 394|550 581|560 581|561 581|562 583|560 585|567 496|455 477|608 537|531 497|452 477|613 592|574 549|522 592|575 466|613 541|608 541|609 542|609 542|531 543|610 540|612 596|578 597|577 541|613 597|579 542|614 542|617 550|530 486|627 549|532 557|617 393|492 540|633 474|639 483|642 525|641 526|642 481|654 394|524 486|656 485|656 467|656 486|658 485|659 487|661 469|661 457|662 482|666 481|670 485|675 484|675 468|676 457|686 474|689 519|690 465|614 538|611 538|612 541|611 539|612 542|615 540|616 480|637 542|632 483|652 485|657 458|678 500|490 501|493 500|493 499|493 514|499 539|550 540|550 536|553 537|555 522|562 533|561 546|555 547|556 545|558 545|560 547|560 549|560 483|485 547|565 538|573 526|578 572|552 523|580 573|553 525|581 525|588 528|589 456|483 526|592 530|592 593|551 593|552 580|576 480|588 467|607 478|612 484|614 498|618 489|620 494|635 486|620 466|616 449|616 446|615 457|627 425|612 434|619 424|615 454|630 609|597 418|615 433|626 435|627 429|624 423|621 434|628 432|628 587|622 589|621 433|629 423|624 432|629 587|623 589|622 589|623 588|624 590|623 587|625 588|625 448|450 422|627 587|627 419|627 589|627 424|630 588|628 591|627 579|634 590|628 645|574 579|635 577|636 581|634 590|629 589|630 591|630 590|631 575|639 585|634 648|574 576|639 590|632 444|462 650|572 577|639 424|636 591|633 590|634 577|641 591|634 592|634 579|641 593|634 592|635 579|642 593|635 569|647 576|644 570|647 409|632 649|585 432|650 432|651 651|596 658|586 654|595 429|658 665|591 409|655 666|597 665|599 677|580 405|657 648|622 679|582 669|599 661|614 684|579 510|703 681|585 681|586 511|704 681|593 673|609 412|675 522|710 417|682 498|626 468|523 377|606 408|671 495|496 498|532 498|537 494|483 495|529 487|527 489|538 488|498 501|548 485|549 533|552 425|587 533|556 527|569 466|542 515|560 532|559 455|520 434|530 638|463 432|518 428|516 426|509 416|516 417|520 418|525 417|516 637|470 643|465 642|469 480|543 496|537 485|560 498|543 514|519 498|507 478|500 470|499 509|517 511|521 538|519 525|504 619|454 337|535 502|506 429|510 507|499 698|476 647|481 691|474 473|517 373|529 321|573 434|598 457|544 451|516 451|599 501|501 420|670 450|514 510|671 481|695 447|535 431|592 539|558 408|470 564|520 455|538 524|494 453|543 407|474 292|536 615|622 433|497 318|578 497|661 482|617 449|536 389|558 522|500 450|515 308|568 433|612 453|523 468|658 326|607 500|498 441|532 427|682 439|542 523|499 408|513 403|669 322|577 404|483 436|531 303|573 437|486 456|532 405|482 525|501 526|500 528|507 521|515 543|503 451|545 526|501 516|504 398|512 462|550 526|502 402|492 515|502 454|543 418|637 514|507 313|593 456|542 326|614 393|504 393|509 390|506 392|507 392|508 601|547 499|541 541|556 506|489 502|495 612|623 574|624 635|592 573|634 564|624 624|617 443|517 437|515 433|514 446|520 373|575 449|522 506|496 484|492 477|496 480|498 326|578 483|493 480|490 507|616 475|496 479|488 482|487 306|578 453|516 457|536 642|466 477|492 504|511 594|631 325|553 657|624 473|510 477|498 595|629 483|706 314|581 481|652 562|630 542|674 669|507 308|566 458|706 504|618 336|608 583|658 575|666 563|677 585|687 630|566 504|614 327|597 588|660 322|593 571|686 574|628 456|658 321|585 322|598 315|557 574|634 309|569 663|504 341|636 443|701 634|566 569|667 663|484 595|612 299|567 516|496 553|499 551|498 468|486 340|534 350|527 449|505 448|503 575|488 485|498 526|532 444|534 429|529 471|520 489|510 508|498 414|484 545|576 576|494 420|494 456|513 399|520 408|498 362|532 325|536 690|483 577|492 509|494 427|494 537|512 481|495 379|535 363|528 573|491 557|500 625|449 507|510 493|495 499|502 489|482 347|535 338|529 430|497 424|495 332|529 345|525 358|528 420|499 421|502 461|516 349|534 350|528 506|506 506|510 604|642 520|500 534|512 435|507 475|514 695|498 636|473 638|474 648|483 646|481 508|497 510|480 369|548 431|507 450|517 461|521 417|534 605|481 488|476 492|483 496|487 507|484 487|475 505|487 496|484 495|481 497|486 494|484 496|485 492|487 466|510 670|490 623|481 625|491 630|486 629|468 609|484 626|464 612|477 604|482 613|479 644|476 628|463 313|548 667|497 319|580 323|597 644|564 574|682 479|705 630|661 332|618 479|658 645|565 561|677 327|598 623|577 343|597 370|545 366|624 413|542 594|646 353|632 334|604 394|602 475|643 619|584 623|667 465|705 317|577 576|674 320|591 578|541 311|566 312|547 464|524 439|515 440|518 464|523 467|520 465|518 408|479 486|526 621|460 469|532 388|651 545|525 525|514 512|498 520|496 535|518 559|502 350|633 476|531 489|536 401|542 495|510 558|499 588|528 546|525 562|499 545|514 605|513 560|501 394|529 586|516 580|516 542|512 395|527 514|502 515|498 511|508 500|504 496|517 511|503 514|497 499|506 497|508 484|499 511|510 354|521 343|523 359|530 472|520 471|521 620|490 653|500 710|497 654|498 652|491 627|480 699|493 650|491 638|485 704|497 639|485 642|482 637|477 708|498 635|496 648|492 708|496 699|496 704|491 628|483 649|492 398|625 475|527 587|638 392|627 359|627 479|697 358|561 424|600 477|615 615|491 463|548 374|539 560|576 423|689 426|619 492|701 294|535 309|543 312|537 306|538 394|630 397|629 455|594 428|643 355|558 586|652 422|693 634|479 640|477 634|489 634|497 701|490 696|492 697|489 708|491 628|478 698|487 699|488 625|480 625|488 624|491 437|510 621|475 670|486 624|463 624|470 618|468 622|464 622|476 624|485 623|479 619|476 633|465 622|483 624|465 479|641 622|468 626|465 629|458 609|481 690|501 611|475 652|486 654|484 406|466 336|533 354|541 347|546 346|546 339|533 310|546 330|523 327|515 332|525 406|516 359|528 385|533 344|531 345|521 581|477 328|540 350|515 371|536 422|500 349|525 420|505 417|496 425|496 456|514 419|485 324|537 355|525 346|536 356|543 336|558 296|551 300|549 356|564 333|544 310|559 313|560 380|532 379|532 342|559 303|560 315|564 316|554 317|556 334|564 312|561 476|495 302|537 299|560 352|532 424|497 629|459 422|493 313|546 420|493 336|540 330|539 369|521 353|497 636|525 362|563 308|553 311|554 456|507 334|556 339|554 485|476 487|477 333|520 575|491 377|530 331|522 332|537 538|513 336|524 333|522 408|515 403|521 341|537 332|533 325|508 703|494 700|487 692|485 497|500 426|497 482|506 421|482 418|483 340|523 396|501 313|544 335|536 314|547 574|493 339|539 509|497 500|497 335|537 334|539 337|534 310|547 576|487 451|506 622|467 470|516 422|511 376|534 620|473 368|537 357|537 383|534 550|509 608|483 367|536 354|531 402|527 318|520 331|513 326|537 576|492 448|655 424|646 426|649 434|651 418|665 433|664 487|489 508|489 504|494 631|459 422|520 610|482 494|494 625|576 478|671 440|674 519|670 595|631 423|678 596|635 385|672 414|669 364|657 367|657 426|644 631|628 487|699 628|643 494|708 623|654 314|600 318|609 401|568 488|495 488|492 480|500 481|498 481|502 485|494 483|496 488|508 483|500 493|496 486|498 489|491 326|544 478|514 408|496 322|514 360|539 611|476 643|473 315|546 484|512 610|480 312|523 321|541 539|514 425|493 330|545 307|550 450|527 427|521 648|477 647|475 316|548 480|511 553|495 412|515 647|479 331|608 559|645 497|705 291|520 342|612 554|684 507|649 341|608 372|623 410|673 449|699 495|645 377|575 384|626 518|641 463|647 439|643 324|575 493|619 377|624 513|636 471|699 516|650 521|692 447|685 371|617 499|655 434|698 411|693 456|700 396|648 558|626 556|635 488|527 371|657 322|574 451|700 457|642 572|635 532|659 493|709 517|669 548|677 558|657 586|622 519|675 383|616 363|587 474|664 536|696 472|609 360|592 386|615 385|614 369|606 314|524 479|673 357|590 492|674 369|612 328|572 523|663 550|647 473|702 557|653 576|662 513|652 586|671 317|576 556|653 380|584 309|544 309|541 341|567 332|574 331|568 559|644 509|647 341|610 521|586 522|607 528|587 524|604 506|614 324|595 509|613 505|616 504|615 505|617 505|619 504|619 391|645 528|610 421|630 502|643 416|642 329|601 362|638 359|623 420|658 416|686 453|656 496|706 328|590 483|684 472|706 480|711 572|657 451|704 420|698 388|679 486|702 389|678 381|644 471|701 480|702 421|694 445|698 409|682 528|675 468|554 438|637 479|654 374|602 468|685 354|597 323|584 454|638 439|569 467|678 439|680 380|627 329|552 349|603 334|551 355|602 345|597 340|522 348|516 469|629 448|695 372|600 356|603 337|544 357|560 344|555 596|660 557|664 595|663 583|672 598|656 587|667 570|692 565|676 574|678 591|676 557|699 589|676 564|683 579|689 321|605 314|539 301|574 305|539 522|603 522|605 521|608 398|596 508|552 424|589 458|615 466|615 465|616 490|608 483|616 428|657 476|669 464|606 357|565 473|618 384|584 404|586 357|556 393|591 358|568 375|579 366|576 367|578 404|604 390|595 402|607 365|580 401|600 387|593 405|588 400|599 368|587 471|616 571|680 403|683 553|684 570|686 346|607 568|688 573|687 567|692 554|690 352|609 581|687 334|609 581|686 583|669 448|603 504|604 379|574 379|573 417|611 375|578 370|576 424|618 424|605 373|578 463|623 371|581 450|613 412|599 444|605 415|599 525|585 393|582 373|568 448|601 382|582 379|566 449|606 371|567 449|610 371|568 461|616 531|599 382|581 468|611 632|513 655|542 334|510 638|552 614|474 532|510 585|488 387|529 520|507 641|554 501|505 649|526 612|509 586|521 339|521 636|556 510|709 331|536 421|495 578|603 584|643 566|653 480|546 400|625 399|679 418|639 456|551 360|594 478|700 419|557 408|610 407|640 392|630 664|569 415|639 618|491 404|644 398|581 407|686 397|640 367|548 376|568 589|635 360|549 540|545 472|700 330|612 467|698 338|615 566|659 327|573 618|561 416|691 481|550 381|642 612|505 428|651 370|547 494|709 618|664 410|635 374|551 491|624 382|650 316|589 430|649 342|607 383|651 376|554 404|640 372|550 428|661 408|626 487|701 445|705 428|645 387|554 472|695 468|701 515|671 423|654 408|636 447|702 614|627 342|623 378|545 354|515 360|554 391|627 390|628 644|535 381|572 400|637 426|658 394|627 424|657 413|635 528|526 404|685 423|691 440|698 599|518 643|537 431|558 355|590 388|630 408|685 390|571 336|603 445|697 314|571 527|634 609|496 518|665 436|647 391|636 572|658 392|642 395|606 496|705 586|524 560|578 377|668 308|555 369|546 417|657 446|659 523|529 348|610 422|538 635|563 519|608 668|505 320|602 372|635 468|625 416|674 644|565 463|621 471|621 347|620 411|634 377|615 553|573 636|567 323|600 519|531 478|709 503|652 454|698 534|538 415|607 630|563 634|565 661|512 549|644 460|707 477|702 520|612 397|606 498|504 467|624 514|607 628|535 560|577 604|598 402|633 410|658 498|706 653|618 417|609 415|650 481|557 344|529 481|555 466|623 617|582 356|639 442|596 311|571 516|547 343|610 415|536 458|670 621|589 587|687 360|635 344|617 470|703 381|599 662|613 495|566 435|701 395|597 595|537 411|648 376|539 408|656 410|648 405|655 605|511 341|609 608|571 505|589 621|494 459|671 655|607 432|700 462|530 610|668 577|538 646|503 346|619 595|649 590|651 664|614 575|688 671|511 679|601 428|518 468|527 441|499 492|476 447|513 443|511 492|481 492|482 510|498 621|476 620|477 622|478 525|566 533|554 451|609 604|550 534|553 466|552 618|577 611|605 617|589 523|576 318|511 324|516 314|534 317|520 316|513 317|532 423|504 424|514 503|503 487|488 479|514 314|544 615|479 485|507 391|517 686|478 414|521 361|526 557|496 399|523 683|490 614|480 449|655 308|550 386|665 383|675 431|700 527|708 392|666 433|694 516|701 394|666 433|693 436|693 417|653 457|699 442|691 468|702 454|696 455|696 503|711 448|691 515|711 451|691 511|709 505|706 516|706 526|707 528|707 518|705 542|707 515|704 537|706 516|704 514|703 441|653 524|704 522|703 517|702 520|702 443|652 515|701 442|651 553|703 519|700 538|701 582|697 447|648 582|694 441|640 453|646 576|692 526|692 520|690 519|689 528|689 521|688 469|646 546|685 472|640 494|646 465|632 496|646 501|646 509|646 484|637 545|650 482|635 462|646 485|635 504|641 499|638 529|645 485|632 483|631 495|636 503|638 565|644 482|628 553|643 522|638 518|636 538|639 516|635 524|636 508|630 505|629 527|633 528|633 521|630 517|629 520|628 524|626 521|625 530|622 533|620 528|619 567|606 566|604 606|681 586|617 614|678 580|618 591|615 589|615 595|613 572|619 607|679 588|615 581|616 585|615 594|612 513|702 596|611 595|611 592|612 613|675 581|615 566|617 630|667 617|672 593|610 614|673 567|616 582|681 591|610 570|615 575|614 583|612 566|615 581|680 577|613 581|612 579|612 613|671 585|610 628|665 590|608 567|613 619|668 571|612 625|665 620|667 614|669 611|670 593|675 604|672 585|608 632|661 605|671 575|610 646|653 610|669 581|608 606|670 625|663 605|670 637|657 607|669 582|607 606|669 633|658 623|662 580|685 629|658 581|683 580|683 632|655 625|658 635|653 624|658 641|648 637|650 640|648 636|650 547|647 653|638 656|635 646|641 671|622 638|645 475|704 639|642 663|625 634|644 599|671 595|672 640|640 637|641 596|671 455|687 596|670 461|689 455|686 594|669 593|669 650|643 580|623 650|642 636|634 592|665 635|632 639|629 627|635 632|632 626|635 647|622 650|637 582|664 663|627 630|631 580|664 660|629 650|636 667|623 635|627 650|635 593|660 643|639 665|623 591|660 644|638 621|633 669|619 589|660 587|660 590|659 594|658 666|620 649|633 656|628 667|619 614|634 626|628 590|642 595|657 648|633 665|620 601|655 597|656 589|658 653|629 647|633 555|662 593|640 595|656 648|632 643|635 649|631 597|655 650|630 654|627 592|656 651|629 648|631 660|622 652|628 661|621 616|630 591|639 651|608 582|641 663|619 597|654 661|620 591|655 663|618 590|638 597|653 589|655 596|636 588|655 618|627 657|622 569|658 587|655 591|654 615|628 586|655 659|620 651|605 601|651 590|654 628|621 564|658 589|654 588|654 658|620 595|652 591|653 567|657 598|651 594|652 564|657 589|653 611|628 584|654 613|627 596|651 592|652 595|651 567|656 595|633 565|656 597|650 589|652 603|648 592|651 595|650 594|650 566|655 597|649 631|635 564|655 584|652 596|631 588|651 592|650 591|650 567|654 590|650 596|648 623|618 583|633 595|648 587|650 591|649 565|653 584|650 561|653 596|628 590|648 566|652 565|652 596|646 559|652 619|617 586|648 581|649 566|651 589|647 596|645 623|614 558|651 591|646 586|647 558|649 566|646 580|640 582|639 563|648 597|631 566|647 564|648 596|632 559|650 567|647 562|649 598|631 565|648 583|640 577|643 597|632 594|634 564|649 580|642 567|648 587|639 594|635 589|638 582|642 584|641 577|645 585|641 594|636 595|636 583|643 594|637 551|620 587|642 589|641 596|637 593|639 581|646 594|639 585|644 587|643 598|637 582|646 595|639 597|638 594|640 581|647 587|644 584|646 597|639"]
                ]
//////////////////////////////////////////
if(localStorage.foxtalTypesVillagesOFF == undefined)
localStorage.foxtalTypesVillagesOFF = "";

if(localStorage.foxtalTypesVillagesDEF== undefined)
localStorage.foxtalTypesVillagesDEF = "";

var attack_table = document.getElementById("incomings_table").children[1].children;
var number = 0;

 for(j in villages)
     {
         if(villages[j][0] == "OFF")
         {
             villages[j][1] += " " + localStorage.foxtalTypesVillagesOFF;
         } else if(villages[j][0] == "DEF")
         {
             villages[j][1] += " " + localStorage.foxtalTypesVillagesDEF;
         }
     }

    for(var i = 1; i < attack_table.length - 1; i++ )
    {
        var attack_name = attack_table[i].children[0].children[2].children[0].children[0].innerText;
        if(!attack_name.includes("/Fox/") && !attack_name.includes("Atak"))
        {
            for(j in villages)
            {
                if(villages[j][1].includes(attack_table[i].children[2].innerText.slice(-12, -5)))
                {
                    attack_table[i].children[0].children[2].children[0].children[1].click();
                    attack_table[i].children[0].children[2].children[1].children[0].value+="/Fox/" + villages[j][0];
                    number++;
                    break;
                }
            }
        }
    }
UI.SuccessMessage(number + " commands to change")
document.getElementById("incomings_table").children[1].children[0].children[0].innerHTML+= "<div><input type='button' onclick = changeName() class='btn btn-target-action' value='Rename'><br>Left: <span id='numberLeft'>"+number+"</span></div>";

var script = document.createElement("script");
script.type="text/javascript";
script.innerHTML=`

function changeName()
{
        for (var i = 0; i < document.getElementsByClassName("btn").length; i++)
    {
        if(document.getElementsByClassName("btn")[i].value == "Zmień nazwę")
        {
            document.getElementsByClassName("btn")[i].click();
            document.getElementById('numberLeft').innerText--;
            break;
        }
    }
}`
document.getElementsByTagName('head')[0].appendChild(script);
